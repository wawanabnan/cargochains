{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container-fluid">
  <div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
      <h3 class="card-title m-0"><i class="fas fa-file-contract"></i> Sales Orders</h3>
      <div class="card-tools">
        <!-- optional toolbar / bulk action -->
        <button type="button" class="btn btn-sm btn-outline-secondary">Bulk Action</button>
      </div>
    </div>
    <div class="card-body p-0">
      <table class="table table-hover table-striped mb-0 align-middle">
        <thead>
          <tr>
            <th style="width:28px;">
              <input type="checkbox" id="check-all">
            </th>
            <th>No.</th>
            <th>Customer</th>
            <th>Date</th>
            <th>Status</th>
            <th class="text-end">Total</th>
          </tr>
        </thead>
        <tbody>
          {% for o in orders %}
           <tr class="clickable-row" data-href="{% url 'sales:order_detail' o.id %}">

            <td>
              <input type="checkbox" class="row-check" value="{{ o.id }}">
            </td>
            <td>
              <a href="{% url 'sales:order_detail' o.id %}">{{ o.number }}</a>
            </td>
            <td>{{ o.customer }}</td>
            <td>{{ o.date|date:"d-m-Y" }}</td>
            <td>
              <span class="badge bg-secondary">{{ o.get_status_display|default:o.status }}</span>
            </td>
            <td class="text-end">{{ o.grand_total|default:o.total|floatformat:2 }}</td>
           </tr>
          {% empty %}
          <tr><td colspan="7" class="text-center text-muted">No orders.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>

<style>
  tr.clickable-row { cursor: pointer; }
  tr.clickable-row:hover { background-color: #f5f5f5; }
</style>

<script>
document.addEventListener("DOMContentLoaded", function() {
  const checkAll = document.getElementById("check-all");
  if (checkAll) {
    checkAll.addEventListener("change", function() {
      document.querySelectorAll(".row-check").forEach(cb => cb.checked = this.checked);
    });
  }

  // Klik baris â†’ redirect
  document.querySelectorAll("tr.clickable-row").forEach(row => {
    row.addEventListener("click", function() {
      const href = this.dataset.href;
      if (href) {
        window.location = href;
      }
    });
  });
});
</script>

{% endblock %}
